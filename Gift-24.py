def gift64_encrypt(plain, key):
    S = [0x1,0xA,0x3,0xC,0x5,0x6,0xF,0x0,0xD,0xE,0xB,0x2,0x9,0x7,0x8,0x4]
    state = [(plain >> (4*i)) & 0xF for i in range(16)]
    for r in range(28):
        state = [S[b] for b in state]
        # permutation omitted
    return sum(state[i] << (4*i) for i in range(16))